# version: 1.9
# Summary: {{{summary}}}
mixed-port: 7890
allow-lan: true
mode: rule
log-level: info
external-controller: '0.0.0.0:9090'
clash-for-android:
    append-system-dns: false
profile:
    tracing: true
dns:
    enable: true
    enhanced-mode: fake-ip
    ipv6: false
    default-nameserver: [223.5.5.5, 119.29.29.29]
    fake-ip-range: 198.18.0.1/16
    use-hosts: true
    nameserver: ['https://doh.pub/dns-query', 'https://dns.alidns.com/dns-query']
    fallback: ['https://doh.dns.sb/dns-query', 'https://dns.cloudflare.com/dns-query', 'https://dns.twnic.tw/dns-query', 'tls://1.0.0.1:853', 'tls://8.8.4.4:853']
    fallback-filter: { geoip: true, ipcidr: [240.0.0.0/4, 0.0.0.0/32] }
tun:
  enable: true
  stack: system # or gvisor
  dns-hijack:
    - 1.0.0.1:53
  auto-route: true # auto set global route
  auto-detect-interface: true # conflict with interface-name

# 设置日志输出级别 (默认级别：silent，即不输出任何内容，以避免因日志内容过大而导致程序内存溢出）。
# 5 个级别：silent / info / warning / error / debug。级别越高日志输出量越大，越倾向于调试，若需要请自行开启。
log-level: silent
# Clash 的 RESTful API
external-controller: '0.0.0.0:9090'

# RESTful API 的口令
secret: f1285e537bddb0c4374a394f582ab71c3d859c0eac3bcc8b9a1cec25f9754091

# 您可以将静态网页资源（如 clash-dashboard）放置在一个目录中，clash 将会服务于 `RESTful API/ui`
# 参数应填写配置目录的相对路径或绝对路径。
external-ui: /home/bell_labs/clash-for-linux/dashboard/public

proxy-providers:
{{#each proxies}}
  provider{{@index}}:
    type: http
    url: "{{{this.url}}}"
    interval: 3600
    path: ./providers/provider{{@index}}.yaml
    # filter: 'a|b' # golang regex string
    health-check:
      enable: true
      interval: 600
      # lazy: true
      url: http://www.gstatic.com/generate_204
{{/each}}
  # provider2:
  #   type: file
  #   path: ./proxy1.yaml
  #   health-check:
  #     enable: true
  #     interval: 36000
  #     url: http://www.gstatic.com/generate_204

proxy-groups:

  - name: 'gateway'
    type: select
    # disable-udp: true
    # filter: 'someregex'
    proxies: 
{{#each proxies}}
      - '{{this.name}}'
{{/each}}
{{#each proxies}}
  - name: '{{this.name}}'
    type: select
    # disable-udp: true
    # filter: 'someregex'
    use:
        - provider{{@index}}  
{{/each}}

rule-providers:
  rules-direct:
    type: http
    behavior: domain
    #url: "https://cdn.jsdelivr.net/gh/mathcoder23/net-rules@main/rules-direct.yaml"
    url: "https://goeasy123.top/.netlify/functions/url_proxxy?url=https://raw.githubusercontent.com/mathcoder23/net-rules/main/rules-direct.yaml"
    path: ./providers/rules-direct.yaml
    interval: 86400
  rules-proxy:
    type: http
    behavior: domain
    #url: "https://cdn.jsdelivr.net/gh/mathcoder23/net-rules@main/rules-proxy.yaml"
    url: "https://goeasy123.top/.netlify/functions/url_proxxy?url=https://raw.githubusercontent.com/mathcoder23/net-rules/main/rules-proxy.yaml"
    path: ./providers/rules-proxy.yaml
    interval: 86400
rules:
    - 'RULE-SET,rules-direct,DIRECT'
    - 'RULE-SET,rules-proxy,gateway'
    - 'GEOIP,CN,DIRECT'
    - 'MATCH,gateway'
